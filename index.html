<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Countdown Widget Generator</title>
		<link
			href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;600&display=swap"
			rel="stylesheet"
		/>
		<style>
			body {
				font-family: 'Roboto', sans-serif;
				max-width: 800px;
				margin: 0 auto;
				padding: 20px;
				background-color: #f5f5f5;
			}
			.form-container {
				background: white;
				padding: 20px;
				border-radius: 8px;
				box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			}
			.form-section {
				margin-bottom: 20px;
				padding: 15px;
				border: 1px solid #eee;
				border-radius: 4px;
			}
			.form-section h3 {
				margin-top: 0;
				color: #333;
			}
			.form-group {
				margin-bottom: 15px;
			}
			label {
				display: block;
				margin-bottom: 5px;
				color: #555;
			}
			input[type='number'],
			input[type='text'],
			select {
				width: 100%;
				padding: 8px;
				border: 1px solid #ddd;
				border-radius: 4px;
				box-sizing: border-box;
			}
			.checkbox-group {
				display: flex;
				align-items: center;
				gap: 8px;
			}
			.checkbox-group input[type='checkbox'] {
				margin: 0;
			}
			button {
				background-color: #4caf50;
				color: white;
				padding: 10px 20px;
				border: none;
				border-radius: 4px;
				cursor: pointer;
				font-size: 16px;
			}
			button:hover {
				background-color: #45a049;
			}
			.result-section {
				margin-top: 20px;
				padding: 15px;
				background: #e9e9e9;
				border-radius: 4px;
			}
			.result-url {
				word-break: break-all;
				padding: 10px;
				background: white;
				border-radius: 4px;
				margin: 10px 0;
			}
			.preview-section {
				margin-top: 20px;
				padding: 15px;
				background: #2c2c2c;
				border-radius: 4px;
			}
			.preview-section h3 {
				color: white;
				margin-top: 0;
			}
			.preview-frame {
				width: 100%;
				height: 100px;
				border: none;
				background: transparent;
			}
		</style>
	</head>
	<body>
		<div class="form-container">
			<h2>Countdown Widget Generator</h2>

			<form id="widgetForm">
				<div class="form-section">
					<h3>Time Settings</h3>
					<div class="form-group">
						<label>Days:</label>
						<input type="number" name="days" min="0" value="0" />
					</div>
					<div class="form-group">
						<label>Hours:</label>
						<input type="number" name="hours" min="0" max="23" value="0" />
					</div>
					<div class="form-group">
						<label>Minutes:</label>
						<input type="number" name="minutes" min="0" max="59" value="0" />
					</div>
					<div class="form-group">
						<label>Seconds:</label>
						<input type="number" name="seconds" min="0" max="59" value="0" />
					</div>
				</div>

				<div class="form-section">
					<h3>Display Options</h3>
					<div class="form-group checkbox-group">
						<input type="checkbox" name="showDays" checked />
						<label>Show Days</label>
					</div>
					<div class="form-group checkbox-group">
						<input type="checkbox" name="showHours" checked />
						<label>Show Hours</label>
					</div>
					<div class="form-group checkbox-group">
						<input type="checkbox" name="showMinutes" checked />
						<label>Show Minutes</label>
					</div>
					<div class="form-group checkbox-group">
						<input type="checkbox" name="showSeconds" checked />
						<label>Show Seconds</label>
					</div>
					<div class="form-group">
						<label>Custom End Message:</label>
						<input type="text" name="message" value="00:00:00:00" />
					</div>
				</div>

				<div class="form-section">
					<h3>Styling</h3>
					<div class="form-group">
						<label>Font Size:</label>
						<input type="text" name="fontSize" value="40px" />
					</div>
					<div class="form-group">
						<label>Font Family:</label>
						<input type="text" name="fontFamily" value="Roboto, sans-serif" />
					</div>
					<div class="form-group">
						<label>Font Weight:</label>
						<input type="text" name="fontWeight" value="600" />
					</div>
					<div class="form-group">
						<label>Text Color:</label>
						<input type="color" name="color" value="#ffffff" />
					</div>
					<div class="form-group">
						<label>Letter Spacing:</label>
						<input type="text" name="letterSpacing" value="0px" />
					</div>
				</div>

				<div class="form-section">
					<h3>Confetti Settings</h3>
					<div class="form-group checkbox-group">
						<input type="checkbox" name="confetti" />
						<label>Enable Confetti</label>
					</div>
					<div class="form-group">
						<label>Particle Count:</label>
						<input type="number" name="particleCount" value="100" />
					</div>
					<div class="form-group">
						<label>Angle:</label>
						<input type="number" name="angle" value="90" />
					</div>
					<div class="form-group">
						<label>Spread:</label>
						<input type="number" name="spread" value="45" />
					</div>
					<div class="form-group">
						<label>Origin Y:</label>
						<input type="number" name="originY" value="0.6" step="0.1" />
					</div>
					<div class="form-group checkbox-group">
						<input type="checkbox" name="flat" />
						<label>Flat Confetti</label>
					</div>
					<div class="form-group checkbox-group">
						<input type="checkbox" name="useEmoji" />
						<label>Use Custom Emoji</label>
					</div>
					<div class="form-group">
						<label>Custom Emoji:</label>
						<input type="text" name="emoji" value="ðŸ¦„" />
					</div>
					<div class="form-group">
						<label>Emoji Scale:</label>
						<input type="number" name="scalar" value="2" step="0.1" />
					</div>
				</div>

				<button type="submit">Generate Widget URL</button>
			</form>

			<div class="preview-section">
				<h3>Live Preview</h3>
				<iframe id="previewFrame" class="preview-frame"></iframe>
			</div>

			<div class="result-section" style="display: none">
				<h3>Your Widget URL:</h3>
				<div class="result-url" id="generatedUrl"></div>
				<button onclick="copyToClipboard()">Copy URL</button>
			</div>
		</div>

		<script>
			// Function to update both URL and preview
			function updateWidgetDisplay(params) {
				const baseUrl =
					window.location.href.replace('index.html', '') +
					'widget/countdown.html';
				const finalUrl = `${baseUrl}?${params.toString()}`;

				// Update URL display
				document.getElementById('generatedUrl').textContent = finalUrl;
				document.querySelector('.result-section').style.display = 'block';

				// Update preview iframe
				document.getElementById('previewFrame').src = finalUrl;
			}

			// Add input event listeners to all form elements for live preview
			const form = document.getElementById('widgetForm');
			const formElements = form.querySelectorAll('input');
			formElements.forEach((element) => {
				element.addEventListener('input', function () {
					const formData = new FormData(form);
					const params = new URLSearchParams();

					const confettiEnabled = form['confetti'].checked;
					const emojiEnabled = form['useEmoji'].checked;

					for (let [key, value] of formData.entries()) {
						if (value !== '') {
							if (key.startsWith('show')) {
								params.append(key, form[key].checked);
							} else if (
								key === 'confetti' ||
								key === 'flat' ||
								key === 'particleCount' ||
								key === 'angle' ||
								key === 'spread' ||
								key === 'originY'
							) {
								if (confettiEnabled) {
									if (key === 'confetti' || key === 'flat') {
										params.append(key, form[key].checked);
									} else {
										params.append(key, value);
									}
								}
							} else if (
								key === 'useEmoji' ||
								key === 'emoji' ||
								key === 'scalar'
							) {
								if (confettiEnabled && emojiEnabled) {
									if (key === 'useEmoji') {
										params.append(key, form[key].checked);
									} else {
										params.append(key, value);
									}
								}
							} else {
								params.append(key, value);
							}
						}
					}
					updateWidgetDisplay(params);
				});
			});

			document
				.getElementById('widgetForm')
				.addEventListener('submit', function (e) {
					e.preventDefault();
					const formData = new FormData(e.target);
					const params = new URLSearchParams();

					const confettiEnabled = e.target['confetti'].checked;
					const emojiEnabled = e.target['useEmoji'].checked;

					for (let [key, value] of formData.entries()) {
						if (value !== '') {
							if (key.startsWith('show')) {
								params.append(key, e.target[key].checked);
							} else if (
								key === 'confetti' ||
								key === 'flat' ||
								key === 'particleCount' ||
								key === 'angle' ||
								key === 'spread' ||
								key === 'originY'
							) {
								if (confettiEnabled) {
									if (key === 'confetti' || key === 'flat') {
										params.append(key, e.target[key].checked);
									} else {
										params.append(key, value);
									}
								}
							} else if (
								key === 'useEmoji' ||
								key === 'emoji' ||
								key === 'scalar'
							) {
								if (confettiEnabled && emojiEnabled) {
									if (key === 'useEmoji') {
										params.append(key, e.target[key].checked);
									} else {
										params.append(key, value);
									}
								}
							} else {
								params.append(key, value);
							}
						}
					}
					updateWidgetDisplay(params);
				});

			function copyToClipboard() {
				const urlText = document.getElementById('generatedUrl').textContent;
				navigator.clipboard
					.writeText(urlText)
					.then(() => {
						alert('URL copied to clipboard!');
					})
					.catch((err) => {
						console.error('Failed to copy URL: ', err);
					});
			}

			// Initialize preview with default values
			document.getElementById('widgetForm').dispatchEvent(new Event('submit'));
		</script>
	</body>
</html>
